---
title: '计算机网络基础' # (Required, max 60)
description: '计算机网络基础.' # (Required, 10 to 160)
publishDate: '2025-2-15 00:08:00' # (Required, Date)
tags:
  - Markdown # (Also can write format like next line)
heroImage: { src: './forest-9380292.jpg', alt: 'an image targetting my article', color: '#B4C6DA' }
# thumbnail.jpg should be in the same folder as the article
draft: false # (set true will only show in development)
language: 'Chinese' # (String as you like)
comment: true # (set false will disable comment, even if you've enabled it in site-config)
---

# 计算机网络基础

### 用寄送快递的例子来理解整个通信流程

1. 主机（`10.11.2.151`）=寄件人
2. 交换机 = 小区快递柜（负责本楼栋的快递收发）
3. 网关（`10.11.2.1`） = 小区门卫（整个小区的出入口）
4. 路由器 = 城市快递分拣中心
5. 运营商 = 跨省运输的物流公司
6. 百度服务器 = 远方的收件人

#### 访问百度的过程就好像：

1. 写好快递单（HTTP请求），把包裹（数据包）交给小区快递柜（交换机）
2. 快递柜发现收件地址是外省，转交给小区门卫（网关）
3. 门卫把包裹交给最近的快递分拣中心（运营商的路由器）
4. 分拣中心通过高速公路（光纤）把包裹运到上海分拣中心（百度所在城市的运营商路由器）
5. 上海分拣中心把包裹送到百度大厦的快递柜（百度机房交换机）
6. 最终由百度服务器签收包裹，并回寄一个包裹（网页数据）给你

#### 关键的概念：

- 网段：`255.255.255.0` 像小区门禁，只有`10.11.2.`*的住户能直接互相访问*
- 网关：是唯一允许出入小区的通道
- 交换机：负责楼内住户（同一网段设备）之间的直接通信
- 路由器：负责不同小区/城市之间的路径选择
- 运营商：拥有高速公路（骨干网）和运输车队（路由设备）的物流公司
- 实际网络通信时，这个过程会在50毫秒内完成，且每个点击都会产生数十个这样的"快递包裹"往返。

#### 🏘️ 小区（网段）内的安全机制：

1. **每家自带门锁（系统防火墙）**
	- Windows/Mac自带防火墙就像住户的门锁，默认拒绝陌生邻居的突然造访
	- 例：你无法直接访问邻居的电脑文件共享
2. **物业严格登记（网络权限控制）**
	- 公司/学校网络会像高端小区物业，记录每个住户（设备MAC地址）
	- 例：新设备接入时需要IT部门审批
3. **独立别墅区（VLAN隔离）**
	- 大型网络会用VLAN技术，把一栋楼虚拟分割成多个"别墅区"
	- 例：公司财务部和市场部的电脑虽然在同个交换机，但属于不同VLAN
4. **加密快递柜（VPN隧道）**
	- 重要数据传输时会建立加密通道，就像用防弹运钞车送快递
	- 例：网银操作时数据全程SSL加密

**🔒 实际防护案例：**

- 家庭的WiFi路由器自带"访客网络"功能，就像给客人单独开个快递柜区域
- 企业级交换机的"端口隔离"功能，让每个住户只能联系物业（网关），不能直接串门
- 高级小区的"人脸识别快递柜"（MAC地址绑定），只有登记过的设备能通信

⚠️ 需要注意的是：如果设备完全不设防（比如关闭防火墙+开启全盘共享），确实像敞开家门一样危险。这解释了为什么：

- 公共WiFi风险较高（像开放小区）
- 企业内网要划分安全区域
- 重要服务器要放在独立的"保险库"（DMZ区）

所以结论是：虽然同网段设备在物理上可以通信，但通过各种"门禁系统"（安全策略）的防护，实际形成了类似「每家都有防盗门+小区有监控+物业要登记」的多层安全体系。

#### IPv4地址不足？？？

IPv4地址只有约43亿个，解决方案主要靠以下"三重魔法"：
1. **第一重魔法：地址分类术**
	
	- 公网IP（全球唯一）：像手机号，中国电信给你家分配的`117.123.156.xxx`
	- 私有IP（局域网重复）：电脑的`10.11.2.151`，相当于公司内部分机号
2. **第二重魔法：NAT转换（网络地址转换）**

   ```
   # 访问百度时的地址转换过程：
   电脑（10.11.2.151:5566）,这里的5566是端口号，可以理解成不同的应用需要不同来的端口号来收发数据 
   → 路由器NAT转换（117.123.156.25:7854） 
   → 百度服务器（220.181.38.150:80）
   
   # 返回时逆向转换：
   百度响应（117.123.156.25:7854） 
   → 路由器查表转换回（10.11.2.151:5566）
   ```
3. **第三重魔法：动态分配**
	
	- 运营商给家庭宽带分配的是临时公网IP（比如每次拨号更换）
	- 企业级NAT（CGNAT）甚至可以让多个家庭共享一个公网IP

##### 🌰 实际案例：

1. 你家和邻居家电脑可能都用192.168.1.100，但通过各自路由器的NAT转换，对外显示不同的公网IP

2. 公司里500台电脑通过1个公网IP上网，靠不同的端口号区分（就像快递单号末端的-001、-002）

#### 为什么不会混乱：
1. 公网IP由IANA统一分配，保证全球唯一
2. 私有IP就像"内部房间号"，离开家门（路由器）就失效
3. NAT路由器像快递中转站，自动记录"谁寄了什么东西"的对应关系
